#include "script_component.hpp"

if (!hasInterface) exitwith {};

[
	{(player distance _this select 0) < 2000},
	{
		params ["_spring", "_radius", "_size"];

		private _springPos = getpos _spring;
		private _effect1 = "#particlesource" createVehicleLocal _springPos;
		_effect1 setParticleCircle [_radius,[2,2,3]];
		_effect1 setParticleRandom [0.1,[0.5,0.5,0.5],[-2,-2,0.5],5,0.5,[0,0,0,0.5],1,0];
		_effect1 setParticleParams [["\A3\data_f\cl_basic",1,0,1],"","Billboard",1,2,[0,0,0],[0,0,3],5,23,7.9,1,[_size,_size,floor (_size/1.5)],[[1,1,1,0.5],[1,1,1,0.1],[1,1,1,0]],[1],1,0,"","",_spring];
		_effect1 setDropInterval 0.05;

		private _effect2 = "#particlesource" createVehicleLocal _springPos;
		_effect2 setParticleCircle [_radius,[2,2,3]];
		_effect2 setParticleRandom [0.5,[0.5,0.5,0.5],[-2,-2,0.5],5,0.5,[0,0,0,0.5],1,0];
		_effect2 setParticleParams [["\A3\data_f\cl_water",1,0,1],"","Billboard",1,1,[0,0,0],[0,0,3],5,23,7.9,1,[_size,_size,floor (_size*0)],[[1,1,1,0],[1,1,1,0.5],[1,1,1,0]],[1],1,0,"","",_spring];
		_effect2 setDropInterval 1;

		private _effect3 = "#particlesource" createVehicleLocal _springPos;
		_effect3 setParticleCircle [_radius,[2,2,3]];
		_effect3 setParticleRandom [0.1,[0.5,0.5,0.5],[-2,-2,0.5],5,0.5,[0,0,0,0.5],1,0];
		_effect3 setParticleParams [["\A3\data_f\cl_fireD",1,0,1],"","Billboard",1,1,[0,0,0],[0,0,3],5,23,7.9,1,[_size,_size,floor (_size/1.5)],[[1,1,1,0.5],[1,1,1,0.5],[1,1,1,0]],[1],1,0,"","",_spring];
		_effect3 setDropInterval 0.1;

		private _effect4 = "#particlesource" createVehicleLocal _springPos;
		_effect4 setParticleCircle [_radius,[2,2,3]];
		_effect4 setParticleRandom [0.1,[0.5,0.5,0.5],[-2,-2,0.5],5,0.5,[0,0,0,0.5],1,0];
		_effect4 setParticleParams [["\A3\data_f\cl_fireD",1,0,1],"","Billboard",1,2,[0,0,0],[0,0,3],5,23,7.9,1,[_size,_size,floor (_size/1.5)],[[1,1,1,0.5],[1,1,1,0.5],[1,1,1,0]],[1],1,0,"","",_spring];
		_effect4 setDropInterval 0.05;

		[
		{
			(player distance _this select 0) > 2000
		},
		{
			{
				deleteVehicle _x;
			}forEach _this select 1;

			(_this select 2) call grad_waterfall_fnc_springEffect;
		},
		[_spring, [_effect1, _effect2, _effect3, _effect4], _this]
	] call CBA_fnc_waitUntilAndExecute;
	},
	_this
] call CBA_fnc_waitUntilAndExecute;
